<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Test Proxy Valorant - Local</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1a1a1a;
      color: white;
      padding: 20px;
    }
    .test-container {
      max-width: 600px;
      margin: 0 auto;
    }
    .result {
      background: #2a2a2a;
      padding: 15px;
      border-radius: 5px;
      margin: 10px 0;
    }
    .success { border-left: 4px solid #4CAF50; }
    .error { border-left: 4px solid #f44336; }
    button {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover { background: #45a049; }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>🧪 Test Proxy Valorant</h1>
    
    <button onclick="testProxy()">🔄 Tester le Proxy</button>
    <button onclick="testAPI()">📡 Tester l'API Valorant</button>
    
    <div id="results"></div>
  </div>

  <script>
    const resultsDiv = document.getElementById('results');
    
    function addResult(message, isSuccess) {
      const div = document.createElement('div');
      div.className = `result ${isSuccess ? 'success' : 'error'}`;
      div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong><br>${message}`;
      resultsDiv.appendChild(div);
      resultsDiv.scrollTop = resultsDiv.scrollHeight;
    }
    
    async function testProxy() {
      addResult('🔄 Test de connexion au proxy...', true);
      
      try {
        const response = await fetch('http://194.164.89.41:1999/health');
        const data = await response.json();
        
        if (response.ok) {
          addResult(`✅ Proxy actif ! Uptime: ${Math.round(data.uptime)}s`, true);
        } else {
          addResult(`❌ Erreur proxy: HTTP ${response.status}`, false);
        }
      } catch (error) {
        addResult(`❌ Erreur connexion: ${error.message}`, false);
      }
    }
    
    async function testAPI() {
      addResult('📡 Test de l\'API Valorant via proxy...', true);
      
      try {
        const response = await fetch('http://194.164.89.41:1999/api/valorant/v3/mmr/eu/pc/ANAKINSKYWALKER/HARR', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'X-API-Key': 'HDEV-6e8ce2b6-0be9-4653-81f6-ee2f4faf32a4'
          }
        });
        
        const data = await response.json();
        
        if (response.ok && data.status === 200) {
          const current = data.data.current;
          addResult(`✅ API Valorant OK !<br>
            🎯 Rang: ${current.tier.name}<br>
            ⭐ RR: ${current.rr}<br>
            🏆 Tier ID: ${current.tier.id}`, true);
        } else {
          addResult(`❌ Erreur API: ${JSON.stringify(data)}`, false);
        }
      } catch (error) {
        addResult(`❌ Erreur API: ${error.message}`, false);
      }
    }
    
    // Test automatique au chargement
    window.onload = () => {
      setTimeout(testProxy, 500);
    };
  </script>
</body>
</html>
