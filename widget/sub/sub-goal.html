<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Twitch Subscribers Counter</title>
    <style>
                body {
            margin: 0;
            padding: 20px;
            font-family: 'Arial', sans-serif;
            color: white;
        }

                .counter-container {
            position: fixed;
            top: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .subscribers-label {
            font-size: 18px;
            font-weight: 600;
            color: white;
        }

        .count {
            font-size: 24px;
            font-weight: bold;
            color: white;
        }

        .goal {
            font-size: 20px;
            color: white;
            position: relative;
            overflow: hidden;
            height: 30px;
        }

        .goal-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            transition: transform 0.5s ease-in-out;
        }

        .goal-content.slide-out {
            transform: translateX(-100%);
        }

        .goal-content.slide-in {
            transform: translateX(100%);
        }

        .goal-content.active {
            transform: translateX(0);
        }

        .error {
            color: white;
            font-size: 14px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
            <div class="counter-container">
            <div class="goal" id="goalText">
                <div class="goal-content active" id="goalContent">0/500 Jeu horreur</div>
            </div>
        </div>

    <script>
        // Twitch API Configuration
        const TWITCH_CONFIG = {
            clientId: 'gp762nuuoqcoxypju8c569th9wz7q5',
            accessToken: 'f9sbwd2bwyz6kqc5z3e2zo7ighquk7',
            broadcasterId: '670947482'
        };

        // Goals configuration
        const GOALS = [
            { count: 500, text: "Jeu horreur" },
            { count: 600, text: "PERMA BAN TRNTY" },
            { count: 650, text: "Unban trnty" },
            { count: 700, text: "..." }
        ];

        // API Endpoints
        const API_ENDPOINTS = {
            followers: `https://api.twitch.tv/helix/channels/followers?broadcaster_id=${TWITCH_CONFIG.broadcasterId}`,
            // For future use when you have subscribers:
            // subscriptions: `https://api.twitch.tv/helix/subscriptions?broadcaster_id=${TWITCH_CONFIG.broadcasterId}`
        };

        // DOM Elements
        const elements = {
            goalText: document.getElementById('goalText'),
            goalContent: document.getElementById('goalContent')
        };

        // Current follower count and goal index
        let currentCount = 0;
        let currentGoalIndex = 0;

                        // Fetch followers count from Twitch API
        async function fetchFollowersCount() {
            try {
                const response = await fetch(API_ENDPOINTS.followers, {
                    headers: {
                        'Client-ID': TWITCH_CONFIG.clientId,
                        'Authorization': `Bearer ${TWITCH_CONFIG.accessToken}`
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();

                // Get total count from pagination
                if (data.pagination && data.pagination.total) {
                    currentCount = data.pagination.total;
                } else {
                    // Fallback: count the followers in the response
                    currentCount = data.data ? data.data.length : 0;
                }

                updateDisplay();

            } catch (error) {
                console.error('Error fetching followers:', error);
            }
        }

                // Get current goal based on follower count
        function getCurrentGoal() {
            for (let i = GOALS.length - 1; i >= 0; i--) {
                if (currentCount >= GOALS[i].count) {
                    return i;
                }
            }
            return 0;
        }

        // Switch to a new goal with animation
        function switchGoal(newGoalIndex) {
            if (newGoalIndex === currentGoalIndex) return;

            const goalContent = elements.goalContent;
            const newGoal = GOALS[newGoalIndex];

            // Slide out current goal
            goalContent.classList.add('slide-out');

            setTimeout(() => {
                // Update content
                goalContent.textContent = `${currentCount}/${newGoal.count} ${newGoal.text}`;

                // Slide in new goal
                goalContent.classList.remove('slide-out');
                goalContent.classList.add('slide-in');

                setTimeout(() => {
                    goalContent.classList.remove('slide-in');
                    goalContent.classList.add('active');
                }, 50);

                currentGoalIndex = newGoalIndex;
            }, 250);
        }

        // Update the display with current count
        function updateDisplay() {
            const newGoalIndex = getCurrentGoal();

            if (newGoalIndex !== currentGoalIndex) {
                switchGoal(newGoalIndex);
            } else {
                // Update current goal text without animation
                const currentGoal = GOALS[currentGoalIndex];
                elements.goalContent.textContent = `${currentCount}/${currentGoal.count} ${currentGoal.text}`;
            }
        }

                        // Initialize the page
        function init() {
            // Set initial goal
            currentGoalIndex = getCurrentGoal();
            const initialGoal = GOALS[currentGoalIndex];
            elements.goalContent.textContent = `0/${initialGoal.count} ${initialGoal.text}`;

            // Fetch initial count
            fetchFollowersCount();

            // Set up automatic refresh every 5 seconds
            setInterval(fetchFollowersCount, 5000);
        }

        // Start the application when page loads
        document.addEventListener('DOMContentLoaded', init);

        // Manual refresh button (optional - you can remove this)
        document.addEventListener('keydown', (e) => {
            if (e.key === 'r' || e.key === 'R') {
                fetchFollowersCount();
            }
        });
    </script>
</body>
</html>
